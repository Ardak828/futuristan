<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>futuristan</title>
  <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/OrbitControls.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
      color: white;
      font-family: 'Inter', sans-serif;
    }
    #overlay {
      position: fixed;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(0, 0, 0, 0.8);
      z-index: 50;
      transition: opacity 0.4s ease;
    }
    #overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
  </style>
</head>

<body>
  <!-- Navigation -->
  <nav class="absolute top-0 left-0 w-full p-4 flex justify-between items-center z-30 bg-black/30 backdrop-blur-sm">
    <div class="text-xl font-bold tracking-widest">futuristan</div>
    <div class="space-x-6 text-sm uppercase tracking-wide">
      <button id="projectsBtn" class="hover:text-gray-400">Projects</button>
    </div>
  </nav>

  <!-- Canvas -->
  <canvas id="bg"></canvas>

  <!-- Modal Overlay -->
  <div id="overlay" class="hidden">
    <div id="modalContent" class="bg-gray-900 p-6 rounded-2xl max-w-lg w-11/12 relative">
      <button id="closeModal" class="absolute top-3 right-3 text-gray-400 hover:text-white text-xl">&times;</button>
      <div id="modalDetails"></div>
      <div class="mt-4 text-right">
        <a id="openProject" href="#" target="_blank" class="text-blue-400 hover:text-blue-300 text-sm">Open Project â†’</a>
      </div>
    </div>
  </div>

  <script>
    let scene, camera, renderer, controls;
    let spheres = [];
    let isModalOpen = false;
    let currentProjectUrl = null;

    const projectModal = document.getElementById('overlay');
    const modalDetailsDiv = document.getElementById('modalDetails');
    const openProjectBtn = document.getElementById('openProject');
    const closeModalBtn = document.getElementById('closeModal');
    const textureLoader = new THREE.TextureLoader();

    const projects = [
      {
        title: "Neo Tengri",
        category: "VR / Speculative",
        description: "A mythological exploration in virtual reality, inspired by Tengriism and ancient symbols.",
        tags: ["VR", "Mythology", "Interactive"],
        color: "#7cc7f6",
        image_path: "https://threejs.org/examples/textures/earth_atmos_2048.jpg",
        url: "https://ardak828.github.io/neotengri/"
      },
      {
        title: "Dreamscapes",
        category: "AI / Installation",
        description: "Visualized dreams through brainwave data transformed into moving imagery.",
        tags: ["AI", "Installation", "Data Art"],
        color: "#f6b07c",
        image_path: "https://threejs.org/examples/textures/planets/jupiter.jpg",
        url: "#"
      },
      {
        title: "Freedom",
        category: "Video / Interactive",
        description: "A digital performance exploring notions of freedom and cultural symbolism.",
        tags: ["Performance", "3D", "Motion"],
        color: "#7cf6a5",
        image_path: "https://threejs.org/examples/textures/planets/mars_1k_color.jpg",
        url: "#"
      }
    ];

    init();
    animate();

    function init() {
      // Scene
      scene = new THREE.Scene();

      // Camera
      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.set(0, 0, 8);

      // Renderer
      renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('bg'), antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.outputEncoding = THREE.sRGBEncoding;

      // Lights
      const ambientLight = new THREE.AmbientLight(0xffffff, 1.5);
      scene.add(ambientLight);
      const pointLight = new THREE.PointLight(0xffffff, 1);
      pointLight.position.set(10, 10, 10);
      scene.add(pointLight);

      // Stars
      const starGeometry = new THREE.BufferGeometry();
      const starVertices = [];
      for (let i = 0; i < 600; i++) {
        starVertices.push(THREE.MathUtils.randFloatSpread(100),
                          THREE.MathUtils.randFloatSpread(100),
                          THREE.MathUtils.randFloatSpread(100));
      }
      starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
      const starMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 0.25 });
      const stars = new THREE.Points(starGeometry, starMaterial);
      scene.add(stars);

      // Project spheres
      createProjectSpheres();

      // Controls
      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.enablePan = false;
      controls.minDistance = 3;
      controls.maxDistance = 20;

      // Events
      window.addEventListener('resize', onWindowResize);
      document.addEventListener('click', onClick);
      document.addEventListener('touchstart', onTouchStart);
      closeModalBtn.addEventListener('click', closeModal);
    }

    function createProjectSpheres() {
      const geometry = new THREE.SphereGeometry(0.8, 32, 32);
      const orbitRadius = 5;

      projects.forEach((proj, i) => {
        const angle = (i / projects.length) * Math.PI * 2;

        const texture = textureLoader.load(proj.image_path);
        const material = new THREE.MeshStandardMaterial({
          map: texture,
          emissive: new THREE.Color(proj.color).multiplyScalar(0.2),
          roughness: 0.6,
          metalness: 0.3
        });

        const sphere = new THREE.Mesh(geometry, material);
        sphere.position.set(Math.cos(angle) * orbitRadius, Math.sin(angle) * orbitRadius, 0);
        sphere.userData = { ...proj, angle, orbitRadius };
        scene.add(sphere);
        spheres.push(sphere);
      });
    }

    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function onClick(event) {
      if (isModalOpen) return;
      const mouse = new THREE.Vector2(
        (event.clientX / window.innerWidth) * 2 - 1,
        -(event.clientY / window.innerHeight) * 2 + 1
      );
      checkIntersection(mouse);
    }

    function onTouchStart(event) {
      if (isModalOpen) return;
      const touch = event.touches[0];
      const mouse = new THREE.Vector2(
        (touch.clientX / window.innerWidth) * 2 - 1,
        -(touch.clientY / window.innerHeight) * 2 + 1
      );
      checkIntersection(mouse);
    }

    function checkIntersection(mouse) {
      const raycaster = new THREE.Raycaster();
      raycaster.setFromCamera(mouse, camera);
      const intersects = raycaster.intersectObjects(spheres);
      if (intersects.length > 0) {
        showProjectModal(intersects[0].object.userData);
      }
    }

    function showProjectModal(project) {
      isModalOpen = true;
      projectModal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';

      modalDetailsDiv.innerHTML = `
        <div class="space-y-4">
          <img src="${project.image_path}" alt="${project.title}"
               class="w-full rounded-lg border border-white/10 shadow-lg object-cover" />
          <div>
            <h3 class="text-xl font-extrabold mb-2">${project.title}</h3>
            <p class="category text-sm uppercase tracking-wide mb-2">${project.category}</p>
            <p class="text-gray-300 text-sm leading-relaxed">${project.description}</p>
          </div>
          <div class="flex flex-wrap gap-2 mt-3">
            ${project.tags.map(tag => `<span class="tag text-xs px-2 py-1 rounded bg-white/10">${tag}</span>`).join('')}
          </div>
        </div>
      `;

      openProjectBtn.href = project.url;
    }

    function closeModal() {
      isModalOpen = false;
      projectModal.classList.add('hidden');
      document.body.style.overflow = 'auto';
    }

    function animate() {
      requestAnimationFrame(animate);
      controls.update();

      spheres.forEach((s, i) => {
        s.userData.angle += 0.001 + i * 0.0002;
        s.position.x = Math.cos(s.userData.angle) * s.userData.orbitRadius;
        s.position.y = Math.sin(s.userData.angle) * s.userData.orbitRadius;
      });

      renderer.render(scene, camera);
    }
  </script>
</body>
</html>
